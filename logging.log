2025-07-17 14:46:12 | INFO     | main                      | ================================================================================
2025-07-17 14:46:12 | INFO     | main                      | STARTING NIR PHANTOM DATASET GENERATION PIPELINE
2025-07-17 14:46:12 | INFO     | main                      | ================================================================================
2025-07-17 14:46:12 | INFO     | main                      | Output directory: /Users/maxhart/Documents/MSc_AI_ML/Dissertation/gitlab/mah422/data
2025-07-17 14:46:12 | INFO     | main                      | Log file: ../logging.log
2025-07-17 14:46:12 | INFO     | main                      | Visualization mode: ENABLED (Development)
2025-07-17 14:46:12 | INFO     | main                      | Generating 5 phantom datasets for machine learning training
2025-07-17 14:46:12 | INFO     | main                      | Expected dataset size: 5 phantoms × 500 probes × 3 detectors = 7,500 tokens
2025-07-17 14:46:12 | INFO     | main                      | ============================================================
2025-07-17 14:46:12 | INFO     | main                      | GENERATING PHANTOM 01/5
2025-07-17 14:46:12 | INFO     | main                      | ============================================================
2025-07-17 14:46:12 | INFO     | main                      | Step 1/6: Constructing phantom geometry
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Generating phantom with 1 tumour(s) using seed 44
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1 successfully placed: 1415/1415 voxels (100.0% embedded)
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Phantom construction completed: 21.1% tissue coverage
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | PHANTOM COMPOSITION BREAKDOWN:
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Total voxels: 125,000
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Air (background):     98,589 voxels (78.9%)
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Healthy tissue:       24,996 voxels (20.0%)
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1:              1,415 voxels (1.1%)
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | Total tumors:         1,415 voxels (1.1%)
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | --------------------------------------------------
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | TOTAL TISSUE:         26,411 voxels (21.1%)
2025-07-17 14:46:12 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:12 | INFO     | main                      | Phantom geometry completed: (50, 50, 50) voxels
2025-07-17 14:46:12 | INFO     | main                      | Step 2/6: Generating finite element mesh
2025-07-17 14:46:12 | INFO     | mesh_volume               | Starting CGAL-based tetrahedral mesh generation with cell_size=1.65
2025-07-17 14:46:14 | INFO     | mesh_volume               | Mesh generation completed: 25464 tetrahedra, 4825 nodes
2025-07-17 14:46:14 | INFO     | create_stndmesh           | Mesh statistics: 25464 tetrahedra, 4825 nodes
2025-07-17 14:46:14 | INFO     | create_stndmesh           | Element volume statistics: 1.029 ± 0.205 mm³
2025-07-17 14:46:14 | INFO     | main                      | FEM mesh generation completed
2025-07-17 14:46:14 | INFO     | main                      | Step 3/6: Assigning optical properties
2025-07-17 14:46:14 | INFO     | assign_optical_properties | Assigning optical properties to 2 tissue regions using seed 42
2025-07-17 14:46:14 | INFO     | assign_optical_properties | Optical properties successfully assigned to mesh elements
2025-07-17 14:46:14 | INFO     | assign_optical_properties | Ground truth maps generated: shape (50, 50, 50, 2)
2025-07-17 14:46:14 | INFO     | main                      | Optical properties assignment completed
2025-07-17 14:46:14 | INFO     | main                      | Step 4/6: Generating probe layout
2025-07-17 14:46:14 | INFO     | extract_surface_voxels    | Surface extraction completed: 3,490 surface voxels identified
2025-07-17 14:46:14 | INFO     | build_random_probe_layout | Starting probe layout generation: 500 probes, min_distance=5mm (no max limit)
2025-07-17 14:46:14 | INFO     | build_random_probe_layout | Probe layout completed: 500 probes placed
2025-07-17 14:46:14 | INFO     | main                      | Probe layout completed: 500 probes, 1500 measurements
2025-07-17 14:46:14 | INFO     | main                      | Step 5/6: Generating probe visualizations
2025-07-17 14:46:29 | INFO     | main                      | Generated INTERACTIVE 3D visualization for phantom 1 probe 1 (for professor demo)
2025-07-17 14:46:29 | INFO     | main                      | Visualization completed in 14.5s
2025-07-17 14:46:29 | INFO     | main                      | Step 6/6: Running frequency-domain simulation
2025-07-17 14:46:29 | INFO     | run_fd_simulation_and_save | Starting FD simulation at 140.0 MHz
2025-07-17 14:46:29 | INFO     | run_fd_simulation_and_save | Mesh configuration: 4,825 nodes, 25,464 elements
2025-07-17 14:46:29 | INFO     | run_fd_simulation_and_save | Measurement configuration: 500 sources, 1500 total measurements
2025-07-17 14:46:37 | INFO     | run_fd_simulation_and_save | FD simulation completed successfully
2025-07-17 14:46:37 | INFO     | run_fd_simulation_and_save | Saving dataset to ../data/phantom_01/phantom_001_scan.h5
2025-07-17 14:46:37 | INFO     | run_fd_simulation_and_save | Tissue labels dataset created with shape: (50, 50, 50)
2025-07-17 14:46:37 | INFO     | run_fd_simulation_and_save | Dataset saved successfully
2025-07-17 14:46:37 | INFO     | run_fd_simulation_and_save | Final dataset: 500 probes × 3 detectors
2025-07-17 14:46:37 | INFO     | run_fd_simulation_and_save | Ground truth shape: 50×50×50 voxels
2025-07-17 14:46:37 | INFO     | main                      | PHANTOM 01 COMPLETED in 25.7s
2025-07-17 14:46:37 | INFO     | main                      | Dataset saved: ../data/phantom_01/phantom_001_scan.h5
2025-07-17 14:46:37 | INFO     | main                      | Sample visualization: ../data/phantom_01/probe_001.png
2025-07-17 14:46:37 | INFO     | main                      | ============================================================
2025-07-17 14:46:37 | INFO     | main                      | GENERATING PHANTOM 02/5
2025-07-17 14:46:37 | INFO     | main                      | ============================================================
2025-07-17 14:46:37 | INFO     | main                      | Step 1/6: Constructing phantom geometry
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Generating phantom with 3 tumour(s) using seed 45
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1 successfully placed: 1023/1023 voxels (100.0% embedded)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 2 successfully placed: 527/527 voxels (100.0% embedded)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 3 successfully placed: 856/885 voxels (96.7% embedded)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Phantom construction completed: 28.0% tissue coverage
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | PHANTOM COMPOSITION BREAKDOWN:
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Total voxels: 125,000
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Air (background):     89,999 voxels (72.0%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Healthy tissue:       32,595 voxels (26.1%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1:              1,023 voxels (0.8%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 2:              527 voxels (0.4%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 3:              856 voxels (0.7%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | Total tumors:         2,406 voxels (1.9%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | --------------------------------------------------
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | TOTAL TISSUE:         35,001 voxels (28.0%)
2025-07-17 14:46:37 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:37 | INFO     | main                      | Phantom geometry completed: (50, 50, 50) voxels
2025-07-17 14:46:37 | INFO     | main                      | Step 2/6: Generating finite element mesh
2025-07-17 14:46:37 | INFO     | mesh_volume               | Starting CGAL-based tetrahedral mesh generation with cell_size=1.65
2025-07-17 14:46:40 | INFO     | mesh_volume               | Mesh generation completed: 33874 tetrahedra, 6310 nodes
2025-07-17 14:46:40 | INFO     | create_stndmesh           | Mesh statistics: 33874 tetrahedra, 6310 nodes
2025-07-17 14:46:40 | INFO     | create_stndmesh           | Element volume statistics: 1.025 ± 0.213 mm³
2025-07-17 14:46:40 | INFO     | main                      | FEM mesh generation completed
2025-07-17 14:46:40 | INFO     | main                      | Step 3/6: Assigning optical properties
2025-07-17 14:46:40 | INFO     | assign_optical_properties | Assigning optical properties to 4 tissue regions using seed 43
2025-07-17 14:46:40 | INFO     | assign_optical_properties | Optical properties successfully assigned to mesh elements
2025-07-17 14:46:40 | INFO     | assign_optical_properties | Ground truth maps generated: shape (50, 50, 50, 2)
2025-07-17 14:46:40 | INFO     | main                      | Optical properties assignment completed
2025-07-17 14:46:40 | INFO     | main                      | Step 4/6: Generating probe layout
2025-07-17 14:46:40 | INFO     | extract_surface_voxels    | Surface extraction completed: 4,170 surface voxels identified
2025-07-17 14:46:40 | INFO     | build_random_probe_layout | Starting probe layout generation: 500 probes, min_distance=5mm (no max limit)
2025-07-17 14:46:40 | INFO     | build_random_probe_layout | Probe layout completed: 500 probes placed
2025-07-17 14:46:40 | INFO     | main                      | Probe layout completed: 500 probes, 1500 measurements
2025-07-17 14:46:40 | INFO     | main                      | Step 5/6: Generating probe visualizations
2025-07-17 14:46:40 | INFO     | main                      | Generated PNG visualization for phantom 2 probe 1 (saved to ../data/phantom_02/probe_001.png)
2025-07-17 14:46:40 | INFO     | main                      | Visualization completed in 0.4s
2025-07-17 14:46:40 | INFO     | main                      | Step 6/6: Running frequency-domain simulation
2025-07-17 14:46:41 | INFO     | run_fd_simulation_and_save | Starting FD simulation at 140.0 MHz
2025-07-17 14:46:41 | INFO     | run_fd_simulation_and_save | Mesh configuration: 6,310 nodes, 33,874 elements
2025-07-17 14:46:41 | INFO     | run_fd_simulation_and_save | Measurement configuration: 500 sources, 1500 total measurements
2025-07-17 14:46:51 | INFO     | run_fd_simulation_and_save | FD simulation completed successfully
2025-07-17 14:46:51 | INFO     | run_fd_simulation_and_save | Saving dataset to ../data/phantom_02/phantom_002_scan.h5
2025-07-17 14:46:51 | INFO     | run_fd_simulation_and_save | Tissue labels dataset created with shape: (50, 50, 50)
2025-07-17 14:46:51 | INFO     | run_fd_simulation_and_save | Dataset saved successfully
2025-07-17 14:46:51 | INFO     | run_fd_simulation_and_save | Final dataset: 500 probes × 3 detectors
2025-07-17 14:46:51 | INFO     | run_fd_simulation_and_save | Ground truth shape: 50×50×50 voxels
2025-07-17 14:46:51 | INFO     | main                      | PHANTOM 02 COMPLETED in 13.5s
2025-07-17 14:46:51 | INFO     | main                      | Dataset saved: ../data/phantom_02/phantom_002_scan.h5
2025-07-17 14:46:51 | INFO     | main                      | Sample visualization: ../data/phantom_02/probe_001.png
2025-07-17 14:46:51 | INFO     | main                      | ============================================================
2025-07-17 14:46:51 | INFO     | main                      | GENERATING PHANTOM 03/5
2025-07-17 14:46:51 | INFO     | main                      | ============================================================
2025-07-17 14:46:51 | INFO     | main                      | Step 1/6: Constructing phantom geometry
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | Generating phantom with 0 tumour(s) using seed 46
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | Phantom construction completed: 22.4% tissue coverage
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | PHANTOM COMPOSITION BREAKDOWN:
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | Total voxels: 125,000
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | Air (background):     96,995 voxels (77.6%)
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | Healthy tissue:       28,005 voxels (22.4%)
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | No tumors placed in this phantom
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | --------------------------------------------------
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | TOTAL TISSUE:         28,005 voxels (22.4%)
2025-07-17 14:46:51 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:46:51 | INFO     | main                      | Phantom geometry completed: (50, 50, 50) voxels
2025-07-17 14:46:51 | INFO     | main                      | Step 2/6: Generating finite element mesh
2025-07-17 14:46:51 | INFO     | mesh_volume               | Starting CGAL-based tetrahedral mesh generation with cell_size=1.65
2025-07-17 14:46:53 | INFO     | mesh_volume               | Mesh generation completed: 26914 tetrahedra, 5085 nodes
2025-07-17 14:46:53 | INFO     | create_stndmesh           | Mesh statistics: 26914 tetrahedra, 5085 nodes
2025-07-17 14:46:53 | INFO     | create_stndmesh           | Element volume statistics: 1.032 ± 0.200 mm³
2025-07-17 14:46:53 | INFO     | main                      | FEM mesh generation completed
2025-07-17 14:46:53 | INFO     | main                      | Step 3/6: Assigning optical properties
2025-07-17 14:46:53 | INFO     | assign_optical_properties | Assigning optical properties to 1 tissue regions using seed 44
2025-07-17 14:46:53 | INFO     | assign_optical_properties | Optical properties successfully assigned to mesh elements
2025-07-17 14:46:53 | INFO     | assign_optical_properties | Ground truth maps generated: shape (50, 50, 50, 2)
2025-07-17 14:46:53 | INFO     | main                      | Optical properties assignment completed
2025-07-17 14:46:53 | INFO     | main                      | Step 4/6: Generating probe layout
2025-07-17 14:46:53 | INFO     | extract_surface_voxels    | Surface extraction completed: 3,624 surface voxels identified
2025-07-17 14:46:53 | INFO     | build_random_probe_layout | Starting probe layout generation: 500 probes, min_distance=5mm (no max limit)
2025-07-17 14:46:53 | INFO     | build_random_probe_layout | Probe layout completed: 500 probes placed
2025-07-17 14:46:53 | INFO     | main                      | Probe layout completed: 500 probes, 1500 measurements
2025-07-17 14:46:53 | INFO     | main                      | Step 5/6: Generating probe visualizations
2025-07-17 14:46:53 | INFO     | main                      | Generated PNG visualization for phantom 3 probe 1 (saved to ../data/phantom_03/probe_001.png)
2025-07-17 14:46:53 | INFO     | main                      | Visualization completed in 0.3s
2025-07-17 14:46:53 | INFO     | main                      | Step 6/6: Running frequency-domain simulation
2025-07-17 14:46:54 | INFO     | run_fd_simulation_and_save | Starting FD simulation at 140.0 MHz
2025-07-17 14:46:54 | INFO     | run_fd_simulation_and_save | Mesh configuration: 5,085 nodes, 26,914 elements
2025-07-17 14:46:54 | INFO     | run_fd_simulation_and_save | Measurement configuration: 500 sources, 1500 total measurements
2025-07-17 14:47:03 | INFO     | run_fd_simulation_and_save | FD simulation completed successfully
2025-07-17 14:47:03 | INFO     | run_fd_simulation_and_save | Saving dataset to ../data/phantom_03/phantom_003_scan.h5
2025-07-17 14:47:03 | INFO     | run_fd_simulation_and_save | Tissue labels dataset created with shape: (50, 50, 50)
2025-07-17 14:47:03 | INFO     | run_fd_simulation_and_save | Dataset saved successfully
2025-07-17 14:47:03 | INFO     | run_fd_simulation_and_save | Final dataset: 500 probes × 3 detectors
2025-07-17 14:47:03 | INFO     | run_fd_simulation_and_save | Ground truth shape: 50×50×50 voxels
2025-07-17 14:47:03 | INFO     | main                      | PHANTOM 03 COMPLETED in 12.3s
2025-07-17 14:47:03 | INFO     | main                      | Dataset saved: ../data/phantom_03/phantom_003_scan.h5
2025-07-17 14:47:03 | INFO     | main                      | Sample visualization: ../data/phantom_03/probe_001.png
2025-07-17 14:47:03 | INFO     | main                      | ============================================================
2025-07-17 14:47:03 | INFO     | main                      | GENERATING PHANTOM 04/5
2025-07-17 14:47:03 | INFO     | main                      | ============================================================
2025-07-17 14:47:03 | INFO     | main                      | Step 1/6: Constructing phantom geometry
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Generating phantom with 4 tumour(s) using seed 47
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1 successfully placed: 415/415 voxels (100.0% embedded)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 2 successfully placed: 527/527 voxels (100.0% embedded)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 3 successfully placed: 597/597 voxels (100.0% embedded)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 4 successfully placed: 513/513 voxels (100.0% embedded)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Phantom construction completed: 19.1% tissue coverage
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | PHANTOM COMPOSITION BREAKDOWN:
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Total voxels: 125,000
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Air (background):     101,113 voxels (80.9%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Healthy tissue:       21,835 voxels (17.5%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1:              415 voxels (0.3%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 2:              527 voxels (0.4%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 3:              597 voxels (0.5%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 4:              513 voxels (0.4%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | Total tumors:         2,052 voxels (1.6%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | --------------------------------------------------
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | TOTAL TISSUE:         23,887 voxels (19.1%)
2025-07-17 14:47:03 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:47:03 | INFO     | main                      | Phantom geometry completed: (50, 50, 50) voxels
2025-07-17 14:47:03 | INFO     | main                      | Step 2/6: Generating finite element mesh
2025-07-17 14:47:03 | INFO     | mesh_volume               | Starting CGAL-based tetrahedral mesh generation with cell_size=1.65
2025-07-17 14:47:05 | INFO     | mesh_volume               | Mesh generation completed: 23168 tetrahedra, 4407 nodes
2025-07-17 14:47:05 | INFO     | create_stndmesh           | Mesh statistics: 23168 tetrahedra, 4407 nodes
2025-07-17 14:47:05 | INFO     | create_stndmesh           | Element volume statistics: 1.020 ± 0.219 mm³
2025-07-17 14:47:05 | INFO     | main                      | FEM mesh generation completed
2025-07-17 14:47:05 | INFO     | main                      | Step 3/6: Assigning optical properties
2025-07-17 14:47:05 | INFO     | assign_optical_properties | Assigning optical properties to 5 tissue regions using seed 45
2025-07-17 14:47:05 | INFO     | assign_optical_properties | Optical properties successfully assigned to mesh elements
2025-07-17 14:47:05 | INFO     | assign_optical_properties | Ground truth maps generated: shape (50, 50, 50, 2)
2025-07-17 14:47:05 | INFO     | main                      | Optical properties assignment completed
2025-07-17 14:47:05 | INFO     | main                      | Step 4/6: Generating probe layout
2025-07-17 14:47:05 | INFO     | extract_surface_voxels    | Surface extraction completed: 3,260 surface voxels identified
2025-07-17 14:47:05 | INFO     | build_random_probe_layout | Starting probe layout generation: 500 probes, min_distance=5mm (no max limit)
2025-07-17 14:47:05 | INFO     | build_random_probe_layout | Probe layout completed: 500 probes placed
2025-07-17 14:47:05 | INFO     | main                      | Probe layout completed: 500 probes, 1500 measurements
2025-07-17 14:47:05 | INFO     | main                      | Step 5/6: Generating probe visualizations
2025-07-17 14:47:06 | INFO     | main                      | Generated PNG visualization for phantom 4 probe 1 (saved to ../data/phantom_04/probe_001.png)
2025-07-17 14:47:06 | INFO     | main                      | Visualization completed in 0.4s
2025-07-17 14:47:06 | INFO     | main                      | Step 6/6: Running frequency-domain simulation
2025-07-17 14:47:06 | INFO     | run_fd_simulation_and_save | Starting FD simulation at 140.0 MHz
2025-07-17 14:47:06 | INFO     | run_fd_simulation_and_save | Mesh configuration: 4,407 nodes, 23,168 elements
2025-07-17 14:47:06 | INFO     | run_fd_simulation_and_save | Measurement configuration: 500 sources, 1500 total measurements
2025-07-17 14:47:14 | INFO     | run_fd_simulation_and_save | FD simulation completed successfully
2025-07-17 14:47:14 | INFO     | run_fd_simulation_and_save | Saving dataset to ../data/phantom_04/phantom_004_scan.h5
2025-07-17 14:47:14 | INFO     | run_fd_simulation_and_save | Tissue labels dataset created with shape: (50, 50, 50)
2025-07-17 14:47:14 | INFO     | run_fd_simulation_and_save | Dataset saved successfully
2025-07-17 14:47:14 | INFO     | run_fd_simulation_and_save | Final dataset: 500 probes × 3 detectors
2025-07-17 14:47:14 | INFO     | run_fd_simulation_and_save | Ground truth shape: 50×50×50 voxels
2025-07-17 14:47:14 | INFO     | main                      | PHANTOM 04 COMPLETED in 10.7s
2025-07-17 14:47:14 | INFO     | main                      | Dataset saved: ../data/phantom_04/phantom_004_scan.h5
2025-07-17 14:47:14 | INFO     | main                      | Sample visualization: ../data/phantom_04/probe_001.png
2025-07-17 14:47:14 | INFO     | main                      | ============================================================
2025-07-17 14:47:14 | INFO     | main                      | GENERATING PHANTOM 05/5
2025-07-17 14:47:14 | INFO     | main                      | ============================================================
2025-07-17 14:47:14 | INFO     | main                      | Step 1/6: Constructing phantom geometry
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Generating phantom with 3 tumour(s) using seed 48
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1 successfully placed: 411/501 voxels (82.0% embedded)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 2 successfully placed: 277/325 voxels (85.2% embedded)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 3 successfully placed: 413/413 voxels (100.0% embedded)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Phantom construction completed: 17.4% tissue coverage
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | PHANTOM COMPOSITION BREAKDOWN:
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Total voxels: 125,000
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Air (background):     103,255 voxels (82.6%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Healthy tissue:       20,644 voxels (16.5%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 1:              411 voxels (0.3%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 2:              277 voxels (0.2%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Tumor 3:              413 voxels (0.3%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | Total tumors:         1,101 voxels (0.9%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | --------------------------------------------------
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | TOTAL TISSUE:         21,745 voxels (17.4%)
2025-07-17 14:47:14 | INFO     | build_phantom_with_tissue_and_tumours | ==================================================
2025-07-17 14:47:14 | INFO     | main                      | Phantom geometry completed: (50, 50, 50) voxels
2025-07-17 14:47:14 | INFO     | main                      | Step 2/6: Generating finite element mesh
2025-07-17 14:47:14 | INFO     | mesh_volume               | Starting CGAL-based tetrahedral mesh generation with cell_size=1.65
2025-07-17 14:47:15 | INFO     | mesh_volume               | Mesh generation completed: 20959 tetrahedra, 4006 nodes
2025-07-17 14:47:16 | INFO     | create_stndmesh           | Mesh statistics: 20959 tetrahedra, 4006 nodes
2025-07-17 14:47:16 | INFO     | create_stndmesh           | Element volume statistics: 1.026 ± 0.209 mm³
2025-07-17 14:47:16 | INFO     | main                      | FEM mesh generation completed
2025-07-17 14:47:16 | INFO     | main                      | Step 3/6: Assigning optical properties
2025-07-17 14:47:16 | INFO     | assign_optical_properties | Assigning optical properties to 4 tissue regions using seed 46
2025-07-17 14:47:16 | INFO     | assign_optical_properties | Optical properties successfully assigned to mesh elements
2025-07-17 14:47:16 | INFO     | assign_optical_properties | Ground truth maps generated: shape (50, 50, 50, 2)
2025-07-17 14:47:16 | INFO     | main                      | Optical properties assignment completed
2025-07-17 14:47:16 | INFO     | main                      | Step 4/6: Generating probe layout
2025-07-17 14:47:16 | INFO     | extract_surface_voxels    | Surface extraction completed: 3,016 surface voxels identified
2025-07-17 14:47:16 | INFO     | build_random_probe_layout | Starting probe layout generation: 500 probes, min_distance=5mm (no max limit)
2025-07-17 14:47:16 | INFO     | build_random_probe_layout | Probe layout completed: 500 probes placed
2025-07-17 14:47:16 | INFO     | main                      | Probe layout completed: 500 probes, 1500 measurements
2025-07-17 14:47:16 | INFO     | main                      | Step 5/6: Generating probe visualizations
2025-07-17 14:47:16 | INFO     | main                      | Generated PNG visualization for phantom 5 probe 1 (saved to ../data/phantom_05/probe_001.png)
2025-07-17 14:47:16 | INFO     | main                      | Visualization completed in 0.4s
2025-07-17 14:47:16 | INFO     | main                      | Step 6/6: Running frequency-domain simulation
2025-07-17 14:47:16 | INFO     | run_fd_simulation_and_save | Starting FD simulation at 140.0 MHz
2025-07-17 14:47:16 | INFO     | run_fd_simulation_and_save | Mesh configuration: 4,006 nodes, 20,959 elements
2025-07-17 14:47:16 | INFO     | run_fd_simulation_and_save | Measurement configuration: 500 sources, 1500 total measurements
2025-07-17 14:47:25 | INFO     | run_fd_simulation_and_save | FD simulation completed successfully
2025-07-17 14:47:25 | INFO     | run_fd_simulation_and_save | Saving dataset to ../data/phantom_05/phantom_005_scan.h5
2025-07-17 14:47:25 | INFO     | run_fd_simulation_and_save | Tissue labels dataset created with shape: (50, 50, 50)
2025-07-17 14:47:25 | INFO     | run_fd_simulation_and_save | Dataset saved successfully
2025-07-17 14:47:25 | INFO     | run_fd_simulation_and_save | Final dataset: 500 probes × 3 detectors
2025-07-17 14:47:25 | INFO     | run_fd_simulation_and_save | Ground truth shape: 50×50×50 voxels
2025-07-17 14:47:25 | INFO     | main                      | PHANTOM 05 COMPLETED in 10.6s
2025-07-17 14:47:25 | INFO     | main                      | Dataset saved: ../data/phantom_05/phantom_005_scan.h5
2025-07-17 14:47:25 | INFO     | main                      | Sample visualization: ../data/phantom_05/probe_001.png
2025-07-17 14:47:25 | INFO     | main                      | ================================================================================
2025-07-17 14:47:25 | INFO     | main                      | BATCH GENERATION COMPLETED SUCCESSFULLY
2025-07-17 14:47:25 | INFO     | main                      | ================================================================================
2025-07-17 14:47:25 | INFO     | main                      | Generated 5 complete phantom datasets
2025-07-17 14:47:25 | INFO     | main                      | Total processing time: 10.6s
2025-07-17 14:47:25 | INFO     | main                      | Output location: /Users/maxhart/Documents/MSc_AI_ML/Dissertation/gitlab/mah422/data
2025-07-17 14:47:25 | INFO     | main                      | Dataset contents per phantom:
2025-07-17 14:47:25 | INFO     | main                      |   • HDF5 file with measurements, geometry, and ground truth
2025-07-17 14:47:25 | INFO     | main                      |   • Sample probe visualization (probe_001.png) for professor demonstration
2025-07-17 14:47:25 | INFO     | main                      |   • Enhanced visualizations enabled for development
2025-07-17 14:47:25 | INFO     | main                      |   • Complete metadata for reproducibility
2025-07-17 14:47:25 | INFO     | main                      | All phantoms generated and saved successfully!
